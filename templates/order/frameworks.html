{% extends "/order_base.html" %}
{% block title %}框架列表{% endblock %}

{% macro all_items(orders) -%}
<table class="table table-bordered table-striped">
    <tr>
        <th>代理集团</th>
        <th>合同金额</th>
        <th>合同号</th>
        <th>直客销售</th>
        <th>渠道销售</th>
        <th>开始</th>
        <th>结束</th>
        <th>回款日期</th>
        <th>合同号状态</th>
        <th>操作</th>
    </tr>
    {% for o in orders %}
    <tr>
        <td>{{o.group.name}}</td>
        <td>{{o.money}}</td>
        <td>{{o.contract or "无合同号"}}</td>
        <td>{{o.direct_sales_names}}</td>
        <td>{{o.agent_sales_names}}</td>
        <td>{{o.start_date_cn}}</td>
        <td>{{o.end_date_cn}}</td>
        <td>{{o.reminde_date_cn}}</td>
        <td>{{o.contract_status_cn}}</td>
        <td>
            <a href="{{url_for("order.framework_order_info", order_id=o.id)}}">合同设置</a>
            {% if g.user.is_super_admin() %}
            <a href="{{url_for("order.framework_delete", order_id=o.id)}}" style="color:red;">删除</a>
            {% endif %}
        </td>
    </tr>
    {% endfor %}
</table>
{%- endmacro %}

{% block main_box %}
<div class="bra-main bra-box">
    <h3> {{title}}</h3>
    <div class="search">
        <input type="button" name="download" value="下载" class="btn btn-sm btn-default" onclick="javascript:download();">
    </div>
    {{ all_items(orders) }}
    <nav>
      <ul class="pagination">
        {% if page-1 > 0 %}
        <li><a href="?p={{page-1}}">&laquo;</a></li>
        {% endif %}
        {% if page-2 > 0 %}
        <li class=""><a href="?p={{page-2}}">{{page-2}}</a></li>
        {% endif %}
        {% if page-1 > 0 %}
        <li class=""><a href="?p={{page-1}}">{{page-1}}</a></li>
        {% endif %}
        <li class="active disable"><a href="#">{{page}}</a></li>
        <li class=""><a href="?p={{page+1}}">{{page+1}}</a></li>
        <li class=""><a href="?p={{page+2}}">{{page+2}}</a></li>
        <li><a href="?p={{page+1}}">&raquo;</a></li>
      </ul>
    </nav>
</div>
<script>
function download(){
    window.location.href = window.location.pathname +
      '?action=download';
}
</script>
{% endblock %}
