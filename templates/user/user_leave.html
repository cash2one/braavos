{% extends "/user_info_base.html" %}
{% block title %}请假列表{% endblock %}

{% block main_box %}
<div class="bra-main bra-box">
    <h3>请假列表
        <a class="btn btn-sm btn-default" href="{{url_for('user.leave_create',user_id = g.user.id)}}">申请请假</a>
    </h3>
    <table class="table table-bordered table-striped">
        <tr>
            <th>请假类型</th>
            <th>开始时间</th>
            <th>结束时间</th>
            <th>发送人</th>
            <th>原因</th>
            <th>状态</th>
            <th width="15%">操作</th>
        </tr>
        {% for l in leaves %}
        <tr>
            <td>{{l.type_cn}}</td>
            <td>{{l.start}}</td>
            <td>{{l.end}}</td>
            <td>{% for k in l.senders %}{{k.name}}</br>{% endfor %}</td>
            <td>{{l.reason}}</td>
            <td>{{l.status_cn}}</td>
            <td>
                {% if l.status == 1 %}
                    <a href="{{url_for('user.leave_update', user_id=g.user.id, lid=l.id)}}">修改</a>
                    <a href="{{url_for('user.leave_apply', user_id=g.user.id, lid=l.id)}}">发送申请</a>
                {% elif l.status == 2 %}
                    <a href="{{url_for('user.leave_apply', user_id=g.user.id, lid=l.id)}}">再次发送申请</a>
                {% endif%}
                {% if g.user.is_super_admin() %}
                    <a href="javascript:check_del('{{url_for('user.leave_delete', user_id=g.user.id, lid=l.id)}}')">删除</a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </table>
</div>
<script>
function check_del(url){ 
    if(confirm("确认要删除这条信息吗？")){ 
        window.location.href = url
    }
}
</script>
{% endblock %}
