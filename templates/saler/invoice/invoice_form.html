{% from '/form.html' import form_field %}
{% macro invoice_form(order, form, INVOICE_TYPE_CN, invoice=None) -%}
{% if invoice %}
{% if order.can_admin(g.user) and invoice.invoice_status in [1, 2, 4] %}
    <div class="well">
        <h4>
            <input type="checkbox" name="invoice-id" class="invoice-id" value="{{invoice.id}}"/>
            {{ invoice.company }}-{{ invoice.money }}元
        </h4>
        <form class="form form-horizontal" method="POST" action="{{url_for('saler_invoice.update_invoice', invoice_id=invoice.id)}}">
        {{form.csrf_token}}
        {{ form_field(form.client_order)}}
        {{ form_field(form.company) }}
        {{ form_field(form.tax_id) }}
        {{ form_field(form.address) }}
        {{ form_field(form.phone) }}
        {{ form_field(form.bank_id) }}
        {{ form_field(form.bank) }}
        {{ form_field(form.detail) }}
        {{ form_field(form.money) }}
        {{ form_field(form.invoice_type) }}
        <input type="submit" class="btn btn-primary btn-sm col-md-offset-2" value="保存"/>
        </form>
    </div>
{% else %}
<div class="col-md-12">
    <div class="col-md-6" style="margin-left: 20px;">
        <table class="table table-bordered">
          <tr>
            <th>时间</th>
            <td>{{invoice.create_time}}</td>
          </tr>
          <tr>
            <th>公司名称</th>
            <td>{{invoice.company}}</td>
          </tr>
          <tr>
            <th>税号</th>
            <td>{{invoice.tax_id}}</td>
          </tr>
          <tr>
            <th>公司地址</th>
            <td>{{invoice.address}}</td>
          </tr>
          <tr>
            <th>联系电话</th>
            <td>{{invoice.phone}}</td>
          </tr>
          <tr>
            <th>银行账号</th>
            <td>{{invoice.bank_id}}</td>
          </tr>
          <tr>
            <th>开户行</th>
            <td>{{invoice.bank}}</td>
          </tr>
          <tr>
            <th>发票内容</th>
            <td>{{invoice.detail}}</td>
          </tr>
          <tr>
            <th>发票金额</th>
            <td>{{invoice.money}}元</td>
          </tr>
          <tr>
            <th>发票类型</th>
            <td>{{INVOICE_TYPE_CN[invoice.invoice_type]}}</td>
          </tr>
        </table>
    </div>
</div>
{% endif %}
{% else %}
    <div class="well">
        <form class="form form-horizontal" method="POST" action="{{url_for('saler_invoice.new_invoice', order_id=order.id)}}">
        {{form.csrf_token}}
        {{ form_field(form.client_order)}}
        {{ form_field(form.company) }}
        {{ form_field(form.tax_id) }}
        {{ form_field(form.address) }}
        {{ form_field(form.phone) }}
        {{ form_field(form.bank_id) }}
        {{ form_field(form.bank) }}
        {{ form_field(form.detail) }}
        {{ form_field(form.money) }}
        {{ form_field(form.invoice_type) }}
        <input type="submit" class="btn btn-primary btn-sm col-md-offset-2" value="保存"/>
        </form>
    </div>
{% endif %}
{%- endmacro %}
